(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{1409:function(t,e,a){"use strict";a.r(e);var n=a(1),o=a.n(n),s=a(2),i=a.n(s),r=a(5),d=a.n(r),l=a(45),c=a(4);o()(document).ready((function(){var t=o()(".component.sweepstakes-entry-page"),e=t.data("event-id");if(t.length){var a=l.a.data();e&&i.a.set(a,"eventId",e),i.a.set(a,"sweepstakesName",a.title);var n=function(t,e){var n=t,o=a;e&&((o=l.a.sourceProps(a.label,a)).eventId=a.eventId,o.sweepstakesName=a.sweepstakesName),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};window.analytics&&t&&!i.a.isEmpty(e)&&l.a.track(t,e)}((n=Object.assign({},o,n)).eventName.toLowerCase(),n)};d()(c.o).subscribe((function(t,e){if((e.is("button")||e.is("a"))&&o()(e).parents(".sweepstakesEntry").length&&"1"!==e.attr("data-tracking-do-not-track")){var a=function(t){var e=t.$target;return{category:"user action",eventName:"clicked to content",label:e.data().trackingLabel,clickType:e.closest("a").find("img").length?"image":"text"}}({$target:e});a&&n(a,!0)}})),d()(c.Jb).subscribe((function(t,e){n({category:"user action",eventName:"content action taken",label:t,action:e,clickType:null})})),d()(c.Ib).subscribe((function(t,e){n({category:"user action",eventName:"content action taken",label:t,action:e,clickType:null})})),d()(c.Vb).subscribe((function(t){var e={category:"user action",metric60:"1",clickType:"text",eventName:"clicked to content",label:"submit sweepstakes",successfulSubmit:t.successfulSubmit,noAdsAvailable:!t.adsAvailable};n(e,!0)}))}}))},288:function(t,e,a){"use strict";a.r(e);var n=a(779),o=a.n(n),s=a(780),i=a.n(s),r=a(1),d=a.n(r),l=a(2),c=a.n(l),u=a(856),p=a.n(u),h=a(791),f=a(12),v=a.n(f),y=a(4),g=a(5),m=a.n(g);a(1409);var b=function(){function t(e){o()(this,t),this.$context=e,this.selectableMedia=!1,this.originalErrorMessage=d()(".alert-banner.type-error .alert-text").html()}return i()(t,[{key:"hidValue",value:function(){var t=c.a.isNil(v.a.get("hid"))?"":v.a.get("hid"),e=c.a.isNil(v.a.get("mdpaccount"))?"":JSON.parse(v.a.get("mdpaccount")).hashId;return t||e}},{key:"postSweepsData",value:function(t){var e=d()(document).find(".inner-container.sweepstakesEntry"),a={type:"POST",data:{hashId:this.hidValue(),eventId:c.a.isNil(this.eventManager.eventId)?"":this.eventManager.eventId,sweepId:e.attr("data-sweepsId")?e.attr("data-sweepsId"):"",nodeId:e.attr("data-nodeid")?e.attr("data-nodeid"):"",regSourceId:e.attr("data-regsrc")?e.attr("data-regsrc"):"",contestStartDate:e.attr("data-entrystart")?e.attr("data-entrystart"):"",contestEndDate:e.attr("data-entryexpire")?e.attr("data-entryexpire"):"",contestEntryLimits:e.attr("data-entrylimit")?e.attr("data-entrylimit"):"",videoComplete:this.selectableMedia,adsAvailable:c.a.get(t,"adsAvailable")||!1,hash:c.a.get(t,"hash"),timestamp:c.a.get(t,"timestamp"),cmsId:c.a.get(t,"cmsId")}};this.jqueryApiCall(a)}},{key:"getSweepsData",value:function(){var t=d()(document).find(".inner-container.sweepstakesEntry"),e={type:"GET",hashId:this.hidValue(),sweepId:t.attr("data-sweepsId")?t.attr("data-sweepsId"):"",nodeId:t.attr("data-nodeid")?t.attr("data-nodeid"):""};c.a.get(e,"hashId")&&this.jqueryApiCall(e)}},{key:"jqueryApiCall",value:function(t){var e=this;p.a.post(Object(h.a)("/user-proxy/sweepstakes-data"),t).then((function(a){var n=a.data.data.data||a.data.data||a.data;200===a.status&&(n.validEntry||"GET"!==t.type||e.entryBannerError(),"POST"===t.type&&(m()(y.Vb).broadcast({successfulSubmit:!0,adsAvailable:c.a.get(t,"data.adsAvailable")}),setTimeout((function(){"daily"===d()(".sweepstakesEntry").attr("data-sweepstakes-type")?window.location.href="/sweepstakes/daily/?entry=".concat(n.nodeId):window.location.href="/sweepstakes/?entry=".concat(n.nodeId)}),500)))})).catch((function(a){if(a.request.status>=400&&"POST"===t.type){if(c.a.get(a,"request.response")){var n=JSON.parse(c.a.get(a,"request.response"))||{};n.message&&e.entryBannerError(n.message)}else e.entryBannerError();m()(y.Vb).broadcast({successfulSubmit:!1,adsAvailable:c.a.get(t,"data.adsAvailable")})}}))}},{key:"entryBannerError",value:function(t){d()(document.body).addClass("entry-disabled"),this.$context.append(d()("<div></div>").addClass("entry-not-valid")),t||(t=this.originalErrorMessage),d()(".alert-banner.type-error .alert-text").html(t),d()(".alert-banner.type-error").removeClass("hidden")}},{key:"init",value:function(){var t=this;this.$context.addClass("initialized"),this.eventManager=new EventManager,this.$context.attr("data-event-id",this.eventManager.eventId),this.getSweepsData(),window.addEventListener(y.Ib,(function(){t.selectableMedia=!0})),document.body.addEventListener(y.Kb,(function(e){t.postSweepsData(e.detail)}))}}]),t}();e.default=function(){d()(".component.sweepstakes-entry-page:not(.initialized)").each((function(){new b(d()(this)).init()}))}},294:function(t,e,a){"use strict";a.r(e);var n=a(779),o=a.n(n),s=a(780),i=a.n(s),r=a(1),d=a.n(r),l=a(2),c=a.n(l),u=a(4),p=a(5),h=a.n(p),f=a(791),v=function(){function t(e){o()(this,t),this.$context=e,this.$photoUploadComponent=e.find(".component.ugc-photo-upload"),this.$alert=e.find(".alert-banner"),this.$uploadedImg=e.find(".js--uploadedImage"),this.$fileInput=e.find(".js--fileInput"),this.$photoMaxUploadSize=this.$fileInput.data("photo-max-upload-size"),this.$favoriteModalLink=d()(".shareicon-favorite-link"),this.contentId=this.$favoriteModalLink.data("content-id"),this.photoUpload={photoId:null,photoUrl:null,step:{getPhotoId:"get_photo_id",uploadPhoto:"photo_upload"}}}return i()(t,[{key:"readUrl",value:function(){var t=this;if(this.$fileInput[0].files&&this.$fileInput[0].files[0]){var e=new FileReader;e.onload=function(e){c.a.set(t.$uploadedImg,"[0].style.backgroundImage","url(".concat(e.target.result,")"))},e.readAsDataURL(this.$fileInput[0].files[0])}}},{key:"showError",value:function(t){this.$alert.removeClass("hidden"),this.$alert.find(".alert-text").text(t)}},{key:"hideError",value:function(){this.$alert.addClass("hidden"),this.$alert.find(".alert-text").text("")}},{key:"photoUploadStatus",value:function(t){t?this.$photoUploadComponent.addClass("uploaded"):this.$photoUploadComponent.removeClass("uploaded")}},{key:"uploadPhoto",value:function(t){var e=this,a=t,n=Object(f.a)("/element-api/content-proxy/photo-upload");d.a.post(n,a,(function(a,n){"success"===n&&(e.hideError(),t.type===e.photoUpload.step.getPhotoId&&(c.a.get(a,"photoId")&&(e.photoUpload.photoId=c.a.get(a,"photoId"),e.photoUpload.photoUrl=c.a.get(a,"imageDestinationUrl")),h()(u.kc).broadcast()),t.type===e.photoUpload.step.uploadPhoto&&e.photoUploadStatus(!0))})).fail((function(t){t.responseJSON&&t.responseJSON.message.includes("dimensions")?(e.showError(t.responseJSON.message),c.a.set(e.$uploadedImg,"[0].style.backgroundImage","")):e.showError("Error submitting. Please try again."),e.photoUploadStatus(!1)}))}},{key:"photoMetaData",value:function(t){return{type:t,filename:this.$fileInput[0].value.replace(/.*[/\\]/,""),contentId:this.contentId}}},{key:"photoUploadData",value:function(t){return{type:t,photoId:this.photoUpload.photoId,photoData:c.a.get(this.$uploadedImg,"[0].style.backgroundImage"),contentId:this.contentId}}},{key:"events",value:function(){var t=this;h()(u.jc).subscribe((function(){var e=t.photoMetaData(t.photoUpload.step.getPhotoId);t.uploadPhoto(e)})),h()(u.kc).subscribe((function(){var e=t.photoUploadData(t.photoUpload.step.uploadPhoto);t.uploadPhoto(e)})),this.$fileInput.on("change",(function(){t.$fileInput[0].value&&(t.$fileInput[0].files[0].size>t.$photoMaxUploadSize?t.showError("Maximum photo size is ".concat(Math.round(t.$photoMaxUploadSize/1024/1024)," MB. Please submit a smaller photo.")):(t.readUrl(t.$fileInput[0],t.$uploadedImg),h()(u.jc).broadcast()))}))}},{key:"init",value:function(){this.events()}}]),t}();e.default=function(){d()(".component.ugc-upload-with-photo").each((function(){new v(d()(this)).init()}))}},779:function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.default=t.exports,t.exports.__esModule=!0},780:function(t,e){function a(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t.exports=function(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t},t.exports.default=t.exports,t.exports.__esModule=!0},791:function(t,e,a){"use strict";a.d(e,"a",(function(){return r}));var n=a(2),o=a.n(n),s=a(1),i=a.n(s);function r(t){return i()(document.body).data("add-slash")&&!o.a.endsWith(t,"/")?"".concat(t,"/"):t}}}]);
//# sourceMappingURL=30-617994b9.js.map