(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{279:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return L}));var n=a(795),s=a.n(n),o=a(796),i=a.n(o),c=a(2),r=a.n(c),l=a(1),d=a.n(l),u=a(5),f=a.n(u),m=a(856),v=a.n(m),p=a(803),h=a(4),b=a(807),g=a(791),w=a(907),C=a(832),k=a(834),y=d()(document.body),j=y.data("save-with-user-api"),x=y.data("save-with-collection"),O=y.data("save-with-success"),D=!1,_=d()(".modal.save-success-modal"),E=_.length?new p.a(_,"save-success-modal"):null,I=d()(".modal.delete-confirmation-modal"),T=I.length?new p.a(I,"delete-confirmation-modal"):null;function S(e){e.find(".icon-text").html("Saved"),e.addClass("saved"),e.removeClass("saving"),f()(h.tb).broadcast()}function B(e){e.find(".icon-text").html("Save"),e.removeClass("saving"),e.removeClass("saved"),console.log("Removed successfully"),f()(h.tb).broadcast()}function z(){return(z=s()(i.a.mark((function e(t){var a,n,s,o,c,l,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=y.attr("data-content-graph-id")||d()(".user-recipe-wrapper").attr("data-content-id")||"",n=y.attr("data-caas-sitename")||"",!(s=a?a.split("/")[1]:"")){e.next=17;break}return e.next=6,Object(k.b)();case 6:return o=e.sent,e.next=9,v.a.post("/user-proxy/getbookmarks",{idToken:o,bookmarkedItemGraphId:s,brand:n});case 9:c=e.sent,l=r.a.get(c,"data.bookmarks[0]"),(u=r.a.get(l,"udf.collections"))&&u.length&&(D=!0),r.a.get(l,"contentGraphId")===a&&(S(t),f()(h.Eb).broadcast(l)),t.addClass("initialized"),e.next=18;break;case 17:t.addClass("initialized");case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t,a){var n=Object(g.a)("/element-api/content-proxy/favorite");d.a.ajax({url:n,type:"GET",data:e,cache:!1,success:function(e,a,n){if(200===n.status){var s=JSON.parse(e);s.IsFavorite&&!0===s.IsFavorite&&(t.find(".icon-text").html("Saved"),t.addClass("saved"),f()(h.tb).broadcast())}}}).fail((function(n){500!==n.status||a||Object(w.a)(F,[e,t])})).always((function(){t.addClass("initialized")}))}function G(e,t,a){if(t.addClass("saving"),j){var n=y.attr("data-caas-sitename")||"",s=y.attr("data-content-graph-id")||d()(".user-recipe-wrapper").attr("data-content-id")||"";Object(C.e)(n,s).then((function(e){r.a.get(e,"data.data.saveBookmark.success")&&S(t)})).catch((function(e){t.removeClass("saving");var a=d()(".shareicon-favorite-link"),n=a.data("content-login-url")||a.data("login-url");n&&"login_required"===r.a.get(e,"code")&&(window.location.href=n)}))}else{var o=Object(g.a)("/element-api/content-proxy/favorite");d.a.post(o,e,(function(e){JSON.parse(e).recipeBoxItemID&&S(t)})).fail((function(n){t.removeClass("saving"),500!==n.status||a||Object(w.a)(G,[e,t])}))}}function J(e){var t=e;t||(t=d()(".shareicon-favorite-link")),t.addClass("saving");var a=y.attr("data-caas-sitename")||"",n=y.attr("data-content-graph-id")||d()(".user-recipe-wrapper").attr("data-content-id")||"";Object(C.b)(a,n).then((function(e){200===r.a.get(e,"status")&&!0===r.a.get(e,"data.data.deleteBookmark.success")&&(B(t),D=!1,f()(h.Fb).broadcast(n))})).catch((function(e){console.error(e)}))}function N(e,t,a){if(j)D?T.open():J(t);else{t.addClass("saving");var n=Object(g.a)("/element-api/content-proxy/favorite");d.a.ajax({url:n,type:"DELETE",data:e,success:function(e,a,n){200===n.status&&B(t)},error:function(n){t.removeClass("saving"),500!==n.status||a||Object(w.a)(N,[e,t])}})}}function L(){var e=d()(".shareicon-favorite-link"),t=e.data("content-id");function a(){e.length&&(y.hasClass("authenticated")?j?function(e){z.apply(this,arguments)}(e):F({id:t},e):(e.attr("aria-label","".concat(e.attr("aria-label")||""," (opens in a new window)")),f()(h.tb).broadcast()))}a(),document.body.addEventListener(h.e,(function(){a()})),f()(h.o).subscribe((function(a,n){if(n.closest(e).length)if(a.preventDefault(),y.hasClass("authenticated")&&e.hasClass("initialized")&&!e.hasClass("saving")){var s={id:t};e.hasClass("saved")?N(s,e):(G(s,e),x?f()(h.W).broadcast():O&&E.open())}else{var o=e.data("content-login-url");o&&setTimeout((function(){window.open(o,"_self")}),0)}else n.closest(".shareNew__deleteButtonCancel").length?(a.preventDefault(),setTimeout((function(){T.close()}),0)):n.closest(".shareNew__deleteButtonRemove").length&&(a.preventDefault(),setTimeout((function(){J(),T.close()}),0))}));var n=d()(".modal.share-icons"),s="",o="";function i(e,t){e[0].target.classList.contains("modal-active")||(d()(".ugc-comments-add-comment").trigger("click"),t.disconnect())}function c(e,t){d()(".js-ugc-comments-outer-comment-wrap").hasClass("test-ugc-comments__hide")&&d()(window).trigger("revealComments"),e.preventDefault(),s.close();var a=t.data("content-id");document.querySelector(a).scrollIntoView(!0)}n.length&&(o=n.find(".content").html(),s=new p.a(n,"share-icons")),f()(h.o).subscribe((function(e,t){var a=d()(".shareicon-modal-toggle"),n=d()(".shareicon-print-link"),r=n.parents(".article-container"),l=d()(".js-view-comments-btn-comments"),u=d()(".js-view-comments-btn-nocomments");if(Object(b.a)(t,a)){e.preventDefault();var f=t.parents(".docked-sharebar").find(".sharebar-modal").html();!f&&t.parents(".longform-main-container").length&&(f=t.parents(".longform-main-container").find(".longform__shareModal").html());var m=t.parents(".shareicon-modal-toggle").data("share-id");m&&(f=d()("#".concat(m)).find(".content").html(),m+="_share-new"),f?s.open(f):s.open(o),t.get(0).id=t.get(0).id||m||"share-id-".concat((new Date).getTime()),s.$modal.data("source-target-id",t.get(0).id)}else if(Object(b.a)(t,n))e.preventDefault(),s&&s.close(),r.addClass("print-article"),window.print(),r.removeClass("print-article");else if(Object(b.a)(t,l))c(e,l);else if(Object(b.a)(t,u)){if(e.preventDefault(),"#ugc-comments"===u.data("content-id"))if(e.stopPropagation(),d()("body").hasClass("authenticated"))new MutationObserver(i).observe(document.body,{attributes:!0}),s.close();else window.location=u.data("content-login-url");else c(e,u)}})),f()(h.r).subscribe((function(){D=!0})),f()(h.Ob).subscribe((function(e){var t=d()(".icon.icon-print").find("a[href$='?printview']");e.preventDefault(),t.click()}))}},907:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(126),s=a.n(n),o=a(2),i=a.n(o),c=a(1),r=a.n(c),l=a(791);function d(e,t){var a=Object(l.a)("/element-api/content-proxy/refresh-cookie");r.a.ajax({url:a,retry:!1,type:"GET",timeout:3e3,xhrFields:{withCredentials:!0},success:function(a){i.a.isArray(a)&&"function"==typeof e&&(i.a.forEach(a,(function(e){document.cookie=e})),e.apply(void 0,s()(t).concat([!0])))}})}}}]);
//# sourceMappingURL=68-f86a241f.js.map